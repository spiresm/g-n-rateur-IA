<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <title>G√©n√©rateur Premium IA Corrig√©</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css"> 
    <style>
        /* Styles minimalistes pour la d√©monstration si styles.css est manquant */
        body { font-family: sans-serif; background: #f4f4f5; color: #333; margin: 0; padding: 20px; }
        .app-shell { max-width: 1400px; margin: 0 auto; background: white; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        header { padding: 20px; background: #1e293b; color: white; display: flex; justify-content: space-between; align-items: center; border-radius: 12px 12px 0 0; }
        .title-group h1 { margin: 0; font-size: 1.5rem; }
        .layout { display: flex; gap: 20px; padding: 20px; }
        .panel { flex: 1; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px; }
        .mode-selector { display: flex; gap: 10px; padding: 20px; }
        .mode-card { flex: 1; padding: 15px; border: 2px solid #e5e7eb; border-radius: 8px; text-align: center; cursor: pointer; transition: all 0.2s; }
        .mode-card.active { border-color: #4f46e5; background: #eef2ff; }
        .btn-main { background: #4f46e5; color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; width: 100%; }
        .ui-input, .ui-select { width: 100%; padding: 8px; margin-top: 5px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .menu-title { border-bottom: 1px solid #e5e7eb; padding-bottom: 10px; margin-bottom: 15px; }
        .log-box { background: #f8fafc; border: 1px solid #e5eeef; padding: 10px; max-height: 200px; overflow-y: auto; font-size: 0.8rem; border-radius: 4px; }
        .log-entry { margin-bottom: 5px; color: #333; }
        .log-error { color: #ef4444; }
        .log-success { color: #10b981; }
        .field-group { margin-bottom: 15px; }
        .dual-field { display: flex; gap: 10px; margin-bottom: 15px; }
        .dual-field > div, .dual-field > input { flex: 1; }
        .dual-field label { display: block; }
        .panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .pill-green { background: #10b981; color: white; padding: 4px 8px; border-radius: 9999px; font-size: 0.75rem; }
        .format-select { display: flex; gap: 10px; margin-bottom: 15px; }
        .format-option { flex: 1; text-align: center; padding: 8px; border: 1px solid #ccc; border-radius: 4px; cursor: pointer; }
    </style>
</head>

<body>
<div class="app-shell">

    <header>
        <div class="title-group">
            <h1>G√©n√©rateur IA Premium</h1>
            <div class="title-chip">
                <span></span>
                Interface Luxe ‚Ä¢ Mode Avanc√©
            </div>
        </div>

        <div class="gpu-card" id="gpu-card">
            <div class="gpu-main">
                <span class="gpu-label">GPU</span>
                <strong id="gpu-name">‚Äì</strong>
                <div class="gpu-pills">
                    <div class="gpu-pill"><span id="gpu-util">0%</span> ‚Ä¢ Utilisation</div>
                    <div class="gpu-pill"><span id="gpu-mem">0 / 0 Go</span></div>
                </div>
            </div>
            <div class="gpu-status-indicator">
                <div class="gpu-dot"></div>
                <div class="gpu-value" id="gpu-temp">‚Äì ¬∞C</div>
            </div>
        </div>
    </header>

    <div class="mode-selector">
        <div class="mode-card active" data-mode="affiche" id="mode-affiche">
            <div class="mode-icon">üé¨</div>
            <h2>Cr√©er une Affiche</h2>
            <p>Construis une affiche cin√©ma styl√©e et riche.</p>
        </div>

        <div class="mode-card" data-mode="image" id="mode-image">
            <div class="mode-icon">üñºÔ∏è</div>
            <h2>Cr√©er une Image</h2>
            <p>G√©n√®re une image IA artistique ou r√©aliste.</p>
        </div>
    </div>

    <hr class="separator">


    <div class="layout">

        <div class="panel">
            <form id="generation-form-premium">

                <div id="affiche-menu" class="menu-premium" style="display:block;">
                    <h3 class="menu-title">üé¨ Cr√©ation d'Affiche</h3>
                    <p class="menu-sub">Personnalisez chaque aspect pour une affiche cin√©matographique premium.</p>

                    <button type="button" id="affiche-random-btn" class="btn-random btn-secondary">
                        üé≤ G√©n√©rer une Affiche Al√©atoire
                    </button>

                    <div class="field-group">
                        <label>Titre</label>
                        <input id="aff_titre" name="aff_titre" class="ui-input" type="text" placeholder="Ex : LA GRANDE AVENTURE">
                    </div>

                    <div class="field-group">
                        <label>Sous-titre</label>
                        <input id="aff_sous_titre" name="aff_sous_titre" class="ui-input" type="text" placeholder="Ex : La magie commence ici‚Ä¶">
                    </div>

                    <div class="field-group">
                        <label>Tagline (bas de l‚Äôaffiche)</label>
                        <input id="aff_tagline" name="aff_tagline" class="ui-input" type="text" placeholder="Ex : Une aventure inoubliable‚Ä¶">
                    </div>

                    <hr class="separator">

                    <div class="dual-field">
                        <div>
                            <label>Occasion / Th√®me</label>
                            <select id="aff_theme" name="aff_theme" class="ui-select"></select>
                        </div>
                        <input id="aff_theme_custom" name="aff_theme_custom" class="ui-input custom-field" type="text" placeholder="Votre propre th√®me‚Ä¶">
                    </div>

                    <div class="dual-field">
                        <div>
                            <label>Ambiance g√©n√©rale</label>
                            <select id="aff_ambiance" name="aff_ambiance" class="ui-select"></select>
                        </div>
                        <input id="aff_ambiance_custom" name="aff_ambiance_custom" class="ui-input custom-field" type="text" placeholder="D√©crivez votre ambiance‚Ä¶">
                    </div>

                    <hr class="separator">

                    <div class="dual-field">
                        <div>
                            <label>Personnage principal</label>
                            <select id="aff_perso_sugg" name="aff_perso_sugg" class="ui-select"></select>
                        </div>
                        <input id="aff_perso_desc" name="aff_perso_desc" class="ui-input custom-field" type="text" placeholder="Description personnalis√©e‚Ä¶">
                    </div>

                    <div class="dual-field">
                        <div>
                            <label>Environnement</label>
                            <select id="aff_env_sugg" name="aff_env_sugg" class="ui-select"></select>
                        </div>
                        <input id="aff_env_desc" name="aff_env_desc" class="ui-input custom-field" type="text" placeholder="Votre environnement‚Ä¶">
                    </div>

                    <div class="dual-field">
                        <div>
                            <label>Action du personnage</label>
                            <select id="aff_action_sugg" name="aff_action_sugg" class="ui-select"></select>
                        </div>
                        <input id="aff_action_desc" name="aff_action_desc" class="ui-input custom-field" type="text" placeholder="Description personnalis√©e‚Ä¶">
                    </div>

                    <hr class="separator">

                    <div class="field-group">
                        <label>D√©tails suppl√©mentaires</label>
                        <textarea id="aff_details" name="aff_details" class="ui-input textarea" placeholder="Ex : fum√©e, reflets, lumi√®re dramatique‚Ä¶"></textarea>
                    </div>

                    <hr class="separator">

                    <div class="dual-field">
                        <div>
                            <label>Palette</label>
                            <select id="aff_palette" name="aff_palette" class="ui-select"></select>
                        </div>
                        <input id="aff_palette_custom" name="aff_palette_custom" class="ui-input custom-field" type="text" placeholder="Palette personnalis√©e‚Ä¶">
                    </div>

                    <div class="dual-field">
                        <div>
                            <label>Style du titre</label>
                            <select id="aff_style_titre" name="aff_style_titre" class="ui-select"></select>
                        </div>
                        <input id="aff_style_titre_custom" name="aff_style_titre_custom" class="ui-input custom-field" type="text" placeholder="Style personnalis√©‚Ä¶">
                    </div>

                    <button type="button" id="affiche-generate-btn" class="btn-main">
                        ‚ú® G√©n√©rer le Prompt de l‚ÄôAffiche
                    </button>

                </div>


                <div id="image-menu" class="menu-premium" style="display:none;">
                    <h3 class="menu-title">üñºÔ∏è G√©n√©ration d‚ÄôImage</h3>
                    <p class="menu-sub">Cr√©ez une image IA de haute qualit√© √† partir d‚Äôun prompt d√©taill√©.</p>

                    <div class="field-group">
                        <label>Prompt principal</label>
                        <textarea id="image-input-prompt" name="prompt" class="ui-input" style="min-height:130px;"></textarea>
                    </div>

                    <hr class="separator">

                    <div class="field-group">
                        <label>Image de r√©f√©rence (optionnel)</label>
                        <button type="button" id="input-image-browse-btn" class="btn-secondary">üñºÔ∏è Importer une image‚Ä¶</button>
                        <span id="input-image-label" class="file-label">Aucune image s√©lectionn√©e</span>
                        <input id="input-image-file" type="file" accept="image/*" style="display:none;">
                    </div>
                    
                    </div>

            </form>
        </div>


<div class="panel">

    <div class="panel-header">
        <div class="panel-title">
            <span class="icon">üñºÔ∏è</span>
            <div>
                R√©sultat
                <div class="panel-sub">Pr√©visualisation & image finale</div>
            </div>
        </div>
        <span class="pill-green" id="job-status-pill">READY</span>
    </div>

    <button id="generate-button-right-panel" 
            class="btn-main" 
            type="submit" 
            form="generation-form-premium" 
            style="margin-bottom: 18px;">
        üöÄ G√©n√©rer l‚Äôimage
    </button>

    <div class="format-select">
        <div class="format-option" data-format="square">‚ñ¢ Carr√©</div>
        <div class="format-option" data-format="portrait">‚ñØ Portrait</div>
        <div class="format-option" data-format="landscape">‚ñ¨ Paysage</div>
    </div>

    <div id="result-area">
        <div id="progress-overlay" style="display:none;">
            <div id="progress-spinner"></div>
            <div id="progress-meta">
                <span id="progress-label">En attente‚Ä¶</span>
                <span id="progress-percent">0%</span>
            </div>

            <div class="progress-bar-large">
                <div class="progress-inner-large" id="progress-inner"></div>
            </div>
        </div>

        <div id="result-placeholder">
            <p>Aucune image encore g√©n√©r√©e.</p>
        </div>
    </div>

    <div class="panel-subtitle" style="margin-top:20px;">üéØ Prompt g√©n√©r√©</div>
    <textarea id="generated-prompt-output" class="ui-input" style="min-height:130px;" readonly></textarea>

    <div class="panel-subtitle">üìú Console</div>
    <div id="log-container" class="log-box"></div>

    <div id="result-footer" style="margin-top: 18px;">
        <button type="button" id="copy-params-btn" class="btn-secondary">
            üìã Copier les param√®tres
        </button>
    </div>

</div>


<div id="image-modal" class="modal">
    <div class="modal-content">
        <span class="modal-close-btn">&times;</span>
        <img id="modal-image" src="" alt="Image HD">
        <a id="modal-download-link" href="#" download class="btn-secondary">T√©l√©charger l‚Äôimage</a>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const form = document.getElementById('generation-form-premium');
        const afficheMenu = document.getElementById('affiche-menu');
        const imageMenu = document.getElementById('image-menu');
        const modeCards = document.querySelectorAll('.mode-card');
        const afficheGenerateBtn = document.getElementById('affiche-generate-btn');
        const generatedPromptOutput = document.getElementById('generated-prompt-output');
        const logContainer = document.getElementById('log-container');
        
        // --- 1. FONCTION DE LOGGING ---
        function logToConsole(message, type = 'info') {
            const entry = document.createElement('div');
            entry.classList.add('log-entry', `log-${type}`);
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logContainer.prepend(entry);
        }

        // --- 2. FONCTION POUR PEUPLER LES SELECTS (pour l'aspect fonctionnel) ---
        function populateSelects() {
            const themes = ['Anniversaire', 'No√´l', 'Halloween', 'Vacances'];
            const ambiances = ['festive et color√©e', 'sombre et myst√©rieuse', '√©pique et dramatique'];
            const perso = ['un enfant joyeux', 'un super-h√©ros', 'un robot stylis√©'];
            const env = ['un d√©cor enneig√©', 'une salle de f√™te', 'un ch√¢teau hant√©'];
            const action = ['ouvre un cadeau', 'vole dans le ciel', 'combat un monstre'];
            const palette = ['couleurs chaudes', 'couleurs froides', 'pastels doux'];
            const styleTitre = ['Vintage ann√©es 80', 'N√©on futuriste', 'Classique Hollywood'];

            [
                { id: 'aff_theme', data: themes },
                { id: 'aff_ambiance', data: ambiances },
                { id: 'aff_perso_sugg', data: perso },
                { id: 'aff_env_sugg', data: env },
                { id: 'aff_action_sugg', data: action },
                { id: 'aff_palette', data: palette },
                { id: 'aff_style_titre', data: styleTitre }
            ].forEach(item => {
                const select = document.getElementById(item.id);
                if (select) {
                    select.innerHTML = '<option value="">Choisir...</option>';
                    item.data.forEach(value => {
                        const option = document.createElement('option');
                        option.value = value;
                        option.textContent = value;
                        select.appendChild(option);
                    });
                }
            });
        }
        populateSelects();
        logToConsole("Les listes d√©roulantes de l'Affiche ont √©t√© initialis√©es.", "success");


        // --- 3. GESTION DES MODES (AFFICHE / IMAGE) ---
        modeCards.forEach(card => {
            card.addEventListener('click', () => {
                modeCards.forEach(c => c.classList.remove('active'));
                card.classList.add('active');
                const mode = card.getAttribute('data-mode');

                afficheMenu.style.display = mode === 'affiche' ? 'block' : 'none';
                imageMenu.style.display = mode === 'image' ? 'block' : 'none';
                logToConsole(`Mode s√©lectionn√© : ${mode.toUpperCase()}.`);
            });
        });

        // --- 4. LOGIQUE DE G√âN√âRATION DU PROMPT AFFICHE ---
        function buildAffichePrompt() {
            const elements = [
                document.getElementById('aff_titre').value ? `Titre : "${document.getElementById('aff_titre').value}".` : '',
                document.getElementById('aff_sous_titre').value ? `Sous-titre : "${document.getElementById('aff_sous_titre').value}".` : '',
                document.getElementById('aff_tagline').value ? `Tagline : "${document.getElementById('aff_tagline').value}".` : '',
                document.getElementById('aff_theme_custom').value || document.getElementById('aff_theme').value ? `Th√®me : ${document.getElementById('aff_theme_custom').value || document.getElementById('aff_theme').value}.` : '',
                document.getElementById('aff_ambiance_custom').value || document.getElementById('aff_ambiance').value ? `Ambiance : ${document.getElementById('aff_ambiance_custom').value || document.getElementById('aff_ambiance').value}.` : '',
                document.getElementById('aff_perso_desc').value || document.getElementById('aff_perso_sugg').value ? `Personnage : ${document.getElementById('aff_perso_desc').value || document.getElementById('aff_perso_sugg').value}.` : '',
                document.getElementById('aff_env_desc').value || document.getElementById('aff_env_sugg').value ? `Environnement : ${document.getElementById('aff_env_desc').value || document.getElementById('aff_env_sugg').value}.` : '',
                document.getElementById('aff_action_desc').value || document.getElementById('aff_action_sugg').value ? `Action : ${document.getElementById('aff_action_desc').value || document.getElementById('aff_action_sugg').value}.` : '',
                document.getElementById('aff_details').value ? `D√©tails suppl√©mentaires : ${document.getElementById('aff_details').value}.` : '',
                document.getElementById('aff_palette_custom').value || document.getElementById('aff_palette').value ? `Palette de couleurs : ${document.getElementById('aff_palette_custom').value || document.getElementById('aff_palette').value}.` : '',
                document.getElementById('aff_style_titre_custom').value || document.getElementById('aff_style_titre').value ? `Style du titre : ${document.getElementById('aff_style_titre_custom').value || document.getElementById('aff_style_titre').value}.` : '',
                "Style : Affiche de film stylis√©e, haute qualit√©, √©clairage dramatique."
            ];
            
            return elements.filter(e => e).join(' ');
        }

        afficheGenerateBtn.addEventListener('click', () => {
            const prompt = buildAffichePrompt();
            generatedPromptOutput.value = prompt;
            logToConsole("Le prompt de l'affiche a √©t√© g√©n√©r√© et affich√©.", "success");
        });

        // --- 5. GESTION DE LA SOUMISSION DU FORMULAIRE (Bouton "G√©n√©rer l'image") ---
        form.addEventListener('submit', function(event) {
            event.preventDefault(); // Emp√™che le rechargement de la page
            
            // Simuler le statut "En cours"
            document.getElementById('job-status-pill').textContent = 'IN PROGRESS';
            document.getElementById('job-status-pill').style.backgroundColor = '#f59e0b'; // Jaune

            // 1. D√©terminer le prompt √† utiliser
            const activeMode = document.querySelector('.mode-card.active').getAttribute('data-mode');
            let finalPrompt = '';

            if (activeMode === 'affiche') {
                // Si mode Affiche, on prend le prompt construit pr√©c√©demment (ou on le reconstruit)
                finalPrompt = generatedPromptOutput.value || buildAffichePrompt();
            } else if (activeMode === 'image') {
                // Si mode Image, on prend le prompt saisi directement
                finalPrompt = document.getElementById('image-input-prompt').value;
            }

            if (!finalPrompt) {
                logToConsole("ERREUR: Veuillez g√©n√©rer ou saisir un prompt avant de lancer.", "error");
                document.getElementById('job-status-pill').textContent = 'ERROR';
                document.getElementById('job-status-pill').style.backgroundColor = '#ef4444'; // Rouge
                return;
            }

            // 2. Afficher le prompt final dans la zone de r√©sultat (si ce n'√©tait pas fait)
            generatedPromptOutput.value = finalPrompt;

            logToConsole(`G√©n√©ration lanc√©e pour le mode ${activeMode.toUpperCase()}. Prompt: ${finalPrompt.substring(0, 50)}...`, "info");
            
            // 3. Simuler le processus de g√©n√©ration (remplacer par votre appel API)
            setTimeout(() => {
                logToConsole("G√©n√©ration termin√©e avec succ√®s !", "success");
                document.getElementById('job-status-pill').textContent = 'COMPLETE';
                document.getElementById('job-status-pill').style.backgroundColor = '#10b981'; // Vert
                document.getElementById('time-taken').textContent = '15.4s';
            }, 3000); // 3 secondes de simulation
        });
    });
</script>
</body>
</html>
